{"generatedAt":1708016518971,"generateTime":834,"contents":[{"_path":"/blog/doorunit-design-v2","_dir":"blog","_draft":false,"_partial":false,"_locale":"","_empty":false,"title":"doorunit-design-v2","description":"How we redesinged the whole doorunit, based on experience from version 1","lang":"English üá¨üáß","author":"Kai Mayer","tags":["CAD","design","hardware"],"body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"doorunit-design-v2"},"children":[{"type":"text","value":"doorunit-design-v2"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Hey, this articel isn't finished yet, come back in few days..."}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[]}},"_type":"markdown","_id":"content:blog:doorunit-design-v2.md","_source":"content","_file":"blog/doorunit-design-v2.md","_extension":"md"},{"_path":"/blog/fhem-als-tueroeffner","_dir":"blog","_draft":false,"_partial":false,"_locale":"","_empty":false,"title":"FHEM als T√ºr√∂ffner","description":"Wie man FHEM benutzt um mittels Passcode die Haust√ºr zu √∂ffnen","lang":"German üá©üá™","created":"2023-08-18T00:00:00.000Z","author":"Kai Mayer","tags":["fhem","raspberrypi","actions","smarthome","mqtt"],"body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"fhem-als-t√ºr√∂ffner"},"children":[{"type":"text","value":"FHEM als T√ºr√∂ffner"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Der Core der Klingel bietet im wesentlichen eine Schnittstelle via MQTT an, √ºber diese verschiedene Events abgerufen oder ausgel√∂st werden k√∂nnen. Eine integration f√ºr weitere Schnittstellen gibt es nicht (bis auf einen mqtt-http-proxy). Das stellt uns jedoch kaum vor ein Problem, da es gen√ºgend Systeme mit MQTT integration gibt, die problemlos weitere Aufgaben f√ºr uns √ºbernehmen k√∂nnen. So werden wir im folgenden FHEM so konfigurieren, dass ein Pin des Raspberry Pi's beim eingeben von "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"123456789"}]},{"type":"text","value":" als Passcode auf der Kiosk Anwendung des dieKlingel Software Packetes f√ºr drei Sekunden auf HIGH und danach wieder auf LOW geschaltet wird."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Zu allererst werden wir in FHEM ein neues Ger√§t anlegen, welches den GPIO Pin 17 ("},{"type":"element","tag":"a","props":{"href":"https://pinout.xyz/pinout/pin11_gpio17/","rel":["nofollow"]},"children":[{"type":"text","value":"Pin 11"}]},{"type":"text","value":") am Rasperry Pi f√ºr drei Sekunden auf HIGH und danach wieder auf LOW schaltet."}]},{"type":"element","tag":"code","props":{"className":["language-bash"],"code":"sudo addgroup fhem gpio\n","language":"bash","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-970031"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-996399"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-724922"},"children":[{"type":"text","value":"addgroup"}]},{"type":"element","tag":"span","props":{"class":"ct-996399"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-724922"},"children":[{"type":"text","value":"fhem"}]},{"type":"element","tag":"span","props":{"class":"ct-996399"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-724922"},"children":[{"type":"text","value":"gpio"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In der Fhem Befehlszeile:"}]},{"type":"element","tag":"code","props":{"className":["language-fhem"],"code":"define frontdoor RPI_GPIO 17\nattr frontdoor direction output\n","language":"fhem","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"define frontdoor RPI_GPIO 17\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"attr frontdoor direction output"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"So da wir nun den Pin als Ger√§t angelegt habe, k√∂nnen wir den Pin f√ºr drei Sekunden auf HIGH schalten"}]},{"type":"element","tag":"code","props":{"className":["language-fhem"],"code":"set frontdoor on-for-timer 3\n","language":"fhem","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"set frontdoor on-for-timer 3"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Jetzt legen wir uns in der Konfiguration des Cores noch eine Lane an, welche per "},{"type":"element","tag":"a","props":{"href":"https://wiki.fhem.de/wiki/CsrfToken-HowTo","rel":["nofollow"]},"children":[{"type":"text","value":"HTTP den FHEM befehl"}]},{"type":"text","value":" ausf√ºhrt und den Passcode √ºberpr√ºft. Um den FHEM Befehl auszuf√ºhren nehmen wir uns ein kurzes Python Script zu Hilfe"}]},{"type":"element","tag":"code","props":{"className":["language-python"],"code":"import os, json, requests, sys\n\nurl = sys.argv[1]\n\nresponse = requests.request(\"GET\", url)\ntoken = response.headers[\"X-FHEM-csrfToken\"]\nrequests.request(\"GET\", url + \"&XHR=1&fwcsrf=\" + token)\n","language":"python","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-748473"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-996399"},"children":[{"type":"text","value":" os, json, requests, sys\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-996399"},"children":[{"type":"text","value":"url "}]},{"type":"element","tag":"span","props":{"class":"ct-748473"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-996399"},"children":[{"type":"text","value":" sys.argv["}]},{"type":"element","tag":"span","props":{"class":"ct-531245"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-996399"},"children":[{"type":"text","value":"]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-996399"},"children":[{"type":"text","value":"response "}]},{"type":"element","tag":"span","props":{"class":"ct-748473"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-996399"},"children":[{"type":"text","value":" requests.request("}]},{"type":"element","tag":"span","props":{"class":"ct-724922"},"children":[{"type":"text","value":"\"GET\""}]},{"type":"element","tag":"span","props":{"class":"ct-996399"},"children":[{"type":"text","value":", url)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-996399"},"children":[{"type":"text","value":"token "}]},{"type":"element","tag":"span","props":{"class":"ct-748473"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-996399"},"children":[{"type":"text","value":" response.headers["}]},{"type":"element","tag":"span","props":{"class":"ct-724922"},"children":[{"type":"text","value":"\"X-FHEM-csrfToken\""}]},{"type":"element","tag":"span","props":{"class":"ct-996399"},"children":[{"type":"text","value":"]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"class":"ct-996399"},"children":[{"type":"text","value":"requests.request("}]},{"type":"element","tag":"span","props":{"class":"ct-724922"},"children":[{"type":"text","value":"\"GET\""}]},{"type":"element","tag":"span","props":{"class":"ct-996399"},"children":[{"type":"text","value":", url "}]},{"type":"element","tag":"span","props":{"class":"ct-748473"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-996399"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-724922"},"children":[{"type":"text","value":"\"&XHR=1&fwcsrf=\""}]},{"type":"element","tag":"span","props":{"class":"ct-996399"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-748473"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-996399"},"children":[{"type":"text","value":" token)"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Dieses legen wir im Ordner "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"scripts"}]},{"type":"text","value":" im "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"$DIEKLINGEL_HOME"}]},{"type":"text","value":" Verzeichnis ab. Wenn die Anwendung als Snap l√§uft befindet sich das Home Verzeichnis unter "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"/var/snap/dieklingel-core/current"}]},{"type":"text","value":". Jetzt k√∂nne wir eine Lane erstellen, welches den Passcode √ºberpr√ºft und bei korrektem Passcode das eben erstellte Script aufruft."}]},{"type":"element","tag":"code","props":{"className":["language-yaml"],"code":"actions:\n  - trigger: ^unlock$\n    lane: | \n      if [ \"$PASSCODE\" = \"123456789\" ]; then\n        python3 ./scripts/fhem.py \"http://192.168.177.52:8083/fhem?cmd=set frontdoor on-for-timer 3\"\n      fi\n","language":"yaml","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-802111"},"children":[{"type":"text","value":"actions"}]},{"type":"element","tag":"span","props":{"class":"ct-996399"},"children":[{"type":"text","value":":\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-996399"},"children":[{"type":"text","value":"  - "}]},{"type":"element","tag":"span","props":{"class":"ct-802111"},"children":[{"type":"text","value":"trigger"}]},{"type":"element","tag":"span","props":{"class":"ct-996399"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-724922"},"children":[{"type":"text","value":"^unlock$\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-996399"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-802111"},"children":[{"type":"text","value":"lane"}]},{"type":"element","tag":"span","props":{"class":"ct-996399"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-748473"},"children":[{"type":"text","value":"|"}]},{"type":"element","tag":"span","props":{"class":"ct-935236"},"children":[{"type":"text","value":" \n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-724922"},"children":[{"type":"text","value":"      if [ \"$PASSCODE\" = \"123456789\" ]; then\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-724922"},"children":[{"type":"text","value":"        python3 ./scripts/fhem.py \"http://192.168.177.52:8083/fhem?cmd=set frontdoor on-for-timer 3\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-724922"},"children":[{"type":"text","value":"      fi"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Das wars auch schon. Sobal nun der Passcode "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"123456789"}]},{"type":"text","value":" eingegeben wird, wird via FHEM der GPIO Pin 17 f√ºr 3 Sekunden auf HIGH geschaltet, befindet sich am Pin ein Relais, so kann mit diesem die Haust√ºr ge√∂ffnet werden. Jede andere Passcode Eingabe wird ignoriert."}]},{"type":"element","tag":"style","children":[{"type":"text","value":".ct-970031{color:#6F42C1;}\n.ct-996399{color:#24292E;}\n.ct-724922{color:#032F62;}\n.ct-748473{color:#D73A49;}\n.ct-531245{color:#005CC5;}\n.ct-802111{color:#22863A;}\n.ct-935236{color:#B31D28;font-style:italic;}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[]}},"_type":"markdown","_id":"content:blog:fhem-als-tueroeffner.md","_source":"content","_file":"blog/fhem-als-tueroeffner.md","_extension":"md"},{"_path":"/contact","_dir":"","_draft":false,"_partial":false,"_locale":"","_empty":false,"title":"Contact","description":"","body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"contact"},"children":[{"type":"text","value":"Contact"}]},{"type":"element","tag":"h2","props":{"id":"us"},"children":[{"type":"text","value":"üè∞ Us"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"For questions, suggestions or improvments, do not hesitate to contact us. Your could contact us via email "},{"type":"element","tag":"a","props":{"href":"mailto:kai.mayer@dieklingel.com"},"children":[{"type":"text","value":"kai.mayer@dieklingel.com"}]},{"type":"text","value":". Oh and hey, here is my "},{"type":"element","tag":"a","props":{"href":"https://github.com/koifresh/","rel":["nofollow"]},"children":[{"type":"text","value":"GitHub"}]}]},{"type":"element","tag":"h2","props":{"id":"where-to-buy-the-product"},"children":[{"type":"text","value":"üí∏ Where to buy the product"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"At the moment we don't sell dieKlingel as product at it is not planned, becuase you could easily buy every part by yourself and asseble it. If you need any 3d printed parts you can refere to an online 3d printing service or write us an email an we will find a solution. If you still want to buy dieKlingel as a all-in-one product, let us know, so we can consider this in the future."}]},{"type":"element","tag":"h2","props":{"id":"me-myself-and-i"},"children":[{"type":"text","value":"üê≥ Me, Myself and I"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Also check out my personal website "},{"type":"element","tag":"a","props":{"href":"https://mayer.sh","rel":["nofollow"]},"children":[{"type":"text","value":"https://mayer.sh"}]},{"type":"text","value":", and if you would like to send me an encryptet email, please use the pgp key from my webiste "},{"type":"element","tag":"a","props":{"href":"https://mayer.sh/kai@mayer.sh.asc","rel":["nofollow"]},"children":[{"type":"text","value":"https://mayer.sh/kai@mayer.sh.asc"}]}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"us","depth":2,"text":"üè∞ Us"},{"id":"where-to-buy-the-product","depth":2,"text":"üí∏ Where to buy the product"},{"id":"me-myself-and-i","depth":2,"text":"üê≥ Me, Myself and I"}]}},"_type":"markdown","_id":"content:contact.md","_source":"content","_file":"contact.md","_extension":"md"},{"_path":"/hardware","_dir":"","_draft":false,"_partial":false,"_locale":"","_empty":false,"title":"üïπÔ∏è Hardware","description":"There is no dedicated hardware to use with dieKlingel softeare. However we already build one or another doorbell, so there are some hardware components which we used for the builds. The reason why we decided to publish the list of hardware is not to restrict the harware, where the software is runnig on. We wanted to have a place to take a look when you have no idea which hardware to buy and use. But thats not the only reason (no üß¢), over the last few years we stumbled over the same hardware issues over and over again, which, as you can imagne, is not as funny as it sounds. Most of the time it is more a software/configuration issue than a actual hardware issue, so you'll find a list of components and some hints, how we configured the parts, and told them to behave like we wan't.","body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"Ô∏è-hardware"},"children":[{"type":"text","value":"üïπÔ∏è Hardware"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"There is no dedicated hardware to use with dieKlingel softeare. However we already build one or another doorbell, so there are some hardware components which we used for the builds. The reason why we decided to publish the list of hardware is not to restrict the harware, where the software is runnig on. We wanted to have a place to take a look when you have no idea which hardware to buy and use. But thats not the only reason (no üß¢), over the last few years we stumbled over the same hardware issues over and over again, which, as you can imagne, is not as funny as it sounds. Most of the time it is more a software/configuration issue than a actual hardware issue, so you'll find a list of components and some hints, how we configured the parts, and told them to behave like we wan't."}]},{"type":"element","tag":"h2","props":{"id":"the-main-controller"},"children":[{"type":"text","value":"üìü The main controller"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://www.reichelt.de/DE/DE/raspberry-pi-4-b-4x-1-5-ghz-2-gb-ram-wlan-bt-rasp-pi-4-b-2gb-p259919.html?r=1&src=raspberrypi","rel":["nofollow"]},"children":[{"type":"text","value":"Rasberry Pi 4 - 2 GB"}]}]}]},{"type":"element","tag":"h2","props":{"id":"the-audio-interface-speaker-and-microphone"},"children":[{"type":"text","value":"The audio interface (speaker and microphone)"}]},{"type":"element","tag":"h3","props":{"id":"speaker"},"children":[{"type":"text","value":"üîà Speaker"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://www.reichelt.de/raspberry-pi-shield-hi-fi-stereo-sound-hat-wm8960-rpi-shd-stereo-p266063.html","rel":["nofollow"]},"children":[{"type":"text","value":"WM8960 Audio HAT"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://www.waveshare.com/wiki/WM8960_Audio_HAT","rel":["nofollow"]},"children":[{"type":"text","value":"https://www.waveshare.com/wiki/WM8960_Audio_HAT"}]}]}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"In the meantime the driver is builtin into the Raspberry Pi firmware (see: "},{"type":"element","tag":"a","props":{"href":"https://github.com/raspberrypi/linux/pull/4039","rel":["nofollow"]},"children":[{"type":"text","value":"#4093"}]},{"type":"text","value":") but you have to enable it. To enable the driver you have to add the overlay to "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"/boot/config.txt"}]},{"type":"element","tag":"code","props":{"className":["language-ini"],"code":"# Enable the wm8960-soundcard\ndtoverlay=wm8960-soundcard\n","language":"ini","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-326375"},"children":[{"type":"text","value":"# Enable the wm8960-soundcard\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-748473"},"children":[{"type":"text","value":"dtoverlay"}]},{"type":"element","tag":"span","props":{"class":"ct-996399"},"children":[{"type":"text","value":"=wm8960-soundcard"}]}]}]}]}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"You should see the soundcard when running "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"aplay -l"}]},{"type":"text","value":":"},{"type":"element","tag":"code","props":{"className":["language-sh"],"code":"card 4: wm8960soundcard [wm8960-soundcard], device 0: bcm2835-i2s-wm8960-hifi wm8960-hifi-0 [bcm2835-i2s-wm8960-hifi wm8960-hifi-0]\n  Subdevices: 1/1\n  Subdevice #0: subdevice #0\n","language":"sh","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-970031"},"children":[{"type":"text","value":"card"}]},{"type":"element","tag":"span","props":{"class":"ct-996399"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-531245"},"children":[{"type":"text","value":"4"}]},{"type":"element","tag":"span","props":{"class":"ct-724922"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-996399"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-724922"},"children":[{"type":"text","value":"wm8960soundcard"}]},{"type":"element","tag":"span","props":{"class":"ct-996399"},"children":[{"type":"text","value":" [wm8960-soundcard], device 0: bcm2835-i2s-wm8960-hifi wm8960-hifi-0 [bcm2835-i2s-wm8960-hifi wm8960-hifi-0]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-996399"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-970031"},"children":[{"type":"text","value":"Subdevices:"}]},{"type":"element","tag":"span","props":{"class":"ct-996399"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-531245"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-724922"},"children":[{"type":"text","value":"/1\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-996399"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-970031"},"children":[{"type":"text","value":"Subdevice"}]},{"type":"element","tag":"span","props":{"class":"ct-996399"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-326375"},"children":[{"type":"text","value":"#0: subdevice #0"}]}]}]}]}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"If the soundcard is not detected, after a reboot, try unplugging the Raspberry Pi from the powersupply and plug in again."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://www.berrybase.de/externer-usb-mini-lautsprecher-schwarz","rel":["nofollow"]},"children":[{"type":"text","value":"External USB Mini Speaker"}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"The USB speaker should work out of the box, however it has a continous quiet hissing, which is nearly impossible to hear, if your ear isn't directly in front of the speaker."}]}]},{"type":"element","tag":"h3","props":{"id":"Ô∏è-microphone"},"children":[{"type":"text","value":"üéôÔ∏è Microphone"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://www.berrybase.de/adafruit-mini-usb-mikrofon","rel":["nofollow"]},"children":[{"type":"text","value":"Mini USB Microphone (adafruit)"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://www.berrybase.de/usb-mini-mikrofon","rel":["nofollow"]},"children":[{"type":"text","value":"Mini USB Microphone"}]}]}]},{"type":"element","tag":"h2","props":{"id":"Ô∏è-the-display"},"children":[{"type":"text","value":"üñ•Ô∏è The display"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://www.amazon.de/Touchscreen-kapazitiver-1024x600-Display-Raspberry/dp/B07YJDSCKR","rel":["nofollow"]},"children":[{"type":"text","value":"7inch HDMI Touchscreen 1024x600"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"http://www.lcdwiki.com/7inch_HDMI_Display-C","rel":["nofollow"]},"children":[{"type":"text","value":"http://www.lcdwiki.com/7inch_HDMI_Display-C"}]}]}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"You do not have to install the driver as described on lcdwiki.com. The display should work out of the box. We just have to rotate it by 90 degrees to put it into portrait mode. To rotate the display you could use the graphical tool "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"ARandR"}]},{"type":"text","value":" which is preinstalled on Raspberry Pi Desktop or you can modify the "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"$HOME/.config/wayfire.ini"}]},{"type":"element","tag":"code","props":{"className":["language-ini"],"code":"[output:HDMI-A-1]\nmode = 1024x600@59821\nposition = 0,0\ntransform = 90\n\n[input-device:wch.cn USB2IIC_CTP_CONTROL]\noutput = HDMI-A-1\n","language":"ini","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-970031"},"children":[{"type":"text","value":"[output:HDMI-A-1]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-748473"},"children":[{"type":"text","value":"mode"}]},{"type":"element","tag":"span","props":{"class":"ct-996399"},"children":[{"type":"text","value":" = 1024x600@59821\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-748473"},"children":[{"type":"text","value":"position"}]},{"type":"element","tag":"span","props":{"class":"ct-996399"},"children":[{"type":"text","value":" = 0,0\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-748473"},"children":[{"type":"text","value":"transform"}]},{"type":"element","tag":"span","props":{"class":"ct-996399"},"children":[{"type":"text","value":" = 90\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-970031"},"children":[{"type":"text","value":"[input-device:wch.cn USB2IIC_CTP_CONTROL]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"class":"ct-748473"},"children":[{"type":"text","value":"output"}]},{"type":"element","tag":"span","props":{"class":"ct-996399"},"children":[{"type":"text","value":" = HDMI-A-1"}]}]}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"You can get the name of the input device (touchscreen) by running "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"libinput list-devices"}]},{"type":"text","value":". However the output rotation is applied as soon as the file is saved, but you have to reboot, to also apply the touchscreen rotation. For more information about the "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"wayfire.ini"}]},{"type":"text","value":" configuration refer to "},{"type":"element","tag":"a","props":{"href":"https://github.com/WayfireWM/wayfire/wiki/Configuration","rel":["nofollow"]},"children":[{"type":"text","value":"https://github.com/WayfireWM/wayfire/wiki/Configuration"}]},{"type":"text","value":"."}]},{"type":"element","tag":"h2","props":{"id":"the-movement-detection"},"children":[{"type":"text","value":"üì° The movement detection"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://www.amazon.de/gp/product/B06XHDGXKL","rel":["nofollow"]},"children":[{"type":"text","value":"Microwave Radarsensor"}]}]}]},{"type":"element","tag":"h2","props":{"id":"the-camera"},"children":[{"type":"text","value":"üì∑ The camera"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://www.amazon.de/gp/product/B074W6TPHF","rel":["nofollow"]},"children":[{"type":"text","value":"Raspberry Pi Camera (OV5647, 160¬∞ Fisheye)"}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"The camera is enabled by default, but since Raspberry Pi switched to libcamera instead of V4L2 it is no longer working with the "},{"type":"element","tag":"a","props":{"href":"https://gitlab.linphone.org/BC/public/mediastreamer2","rel":["nofollow"]},"children":[{"type":"text","value":"mediastreamer2"}]},{"type":"text","value":" used by "},{"type":"element","tag":"a","props":{"href":"https://gitlab.linphone.org/BC/public/liblinphone","rel":["nofollow"]},"children":[{"type":"text","value":"liblinphone"}]},{"type":"text","value":". To bring back the functionality as it was with V4L2 you should use the libcamera-v4l2 module when running the core, as it is used when running the core as service compiled with "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"RASPBERRYPI_LIBCAMERA_SUPPORT=ON"}]},{"type":"text","value":"."},{"type":"element","tag":"code","props":{"className":["language-sh"],"code":"sudo apt-get instal libcamera-v4l2\nLD_PRELOAD=/usr/lib/aarch64-linux-gnu/libcamera/v4l2-compat.so dieklingel-core\n","language":"sh","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-970031"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-996399"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-724922"},"children":[{"type":"text","value":"apt-get"}]},{"type":"element","tag":"span","props":{"class":"ct-996399"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-724922"},"children":[{"type":"text","value":"instal"}]},{"type":"element","tag":"span","props":{"class":"ct-996399"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-724922"},"children":[{"type":"text","value":"libcamera-v4l2\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-996399"},"children":[{"type":"text","value":"LD_PRELOAD"}]},{"type":"element","tag":"span","props":{"class":"ct-748473"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-724922"},"children":[{"type":"text","value":"/usr/lib/aarch64-linux-gnu/libcamera/v4l2-compat.so"}]},{"type":"element","tag":"span","props":{"class":"ct-996399"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-970031"},"children":[{"type":"text","value":"dieklingel-core"}]}]}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"PS: None of the links above are affilate links or in any relationship with us. We don't get a single cent, if you buy something from the parts above. We recommend to check out other sellers for cheaper prices or better delivery conditions."}]}]},{"type":"element","tag":"style","children":[{"type":"text","value":".ct-326375{color:#6A737D;}\n.ct-748473{color:#D73A49;}\n.ct-996399{color:#24292E;}\n.ct-970031{color:#6F42C1;}\n.ct-531245{color:#005CC5;}\n.ct-724922{color:#032F62;}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"the-main-controller","depth":2,"text":"üìü The main controller"},{"id":"the-audio-interface-speaker-and-microphone","depth":2,"text":"The audio interface (speaker and microphone)","children":[{"id":"speaker","depth":3,"text":"üîà Speaker"},{"id":"Ô∏è-microphone","depth":3,"text":"üéôÔ∏è Microphone"}]},{"id":"Ô∏è-the-display","depth":2,"text":"üñ•Ô∏è The display"},{"id":"the-movement-detection","depth":2,"text":"üì° The movement detection"},{"id":"the-camera","depth":2,"text":"üì∑ The camera"}]}},"_type":"markdown","_id":"content:hardware.md","_source":"content","_file":"hardware.md","_extension":"md"},{"_path":"/","_dir":"","_draft":false,"_partial":false,"_locale":"","_empty":false,"title":"dieKlingel","description":"Discover a project aimed at crafting a lightweight, feature-packed doorbell. Enjoy video calling and remote door unlocking, all at a fraction of the usual cost.","body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"dieklingel"},"children":[{"type":"text","value":"dieKlingel"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Discover a project aimed at crafting a lightweight, feature-packed doorbell. Enjoy video calling and remote door unlocking, all at a fraction of the usual cost."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"dieKlingel is a project under the direction of Kai Mayer and Sven Schoch. The idea of the project is it, to build a lightweight doorbell, with a bunch of features like video calling or unlock the door from all over the world."}]},{"type":"element","tag":"h2","props":{"id":"video"},"children":[{"type":"text","value":"Video"}]},{"type":"element","tag":"iframe","props":{"id":"yt-video","src":"https://www.youtube-nocookie.com/embed/WCDt4GCEuzU","title":"YouTube video player","frameBorder":"0","allow":"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share","allowFullScreen":true},"children":[]},{"type":"element","tag":"h2","props":{"id":"inspiration"},"children":[{"type":"text","value":"Inspiration"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Also check out "},{"type":"element","tag":"a","props":{"href":"https://doorpi.org/","rel":["nofollow"]},"children":[{"type":"text","value":"DoorPi"}]},{"type":"text","value":", a great project building a doorbell based on the Raspberry Pi, which is unfortunately no longer active in development."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"For Design inspiration checkout the "},{"type":"element","tag":"a","props":{"href":"https://ux-design-awards.com/winners/residium-door-unit","rel":["nofollow"]},"children":[{"type":"text","value":"Residium Door Unit"}]},{"type":"text","value":", where the harware as well as the software had a great "},{"type":"element","tag":"a","props":{"href":"https://www.residium.com/uploads_residium/2016/02/PRO_Prospekt_DoorUnit_RZ.pdf","rel":["nofollow"]},"children":[{"type":"text","value":"design"}]},{"type":"text","value":". Unfortunately the product line was "},{"type":"element","tag":"a","props":{"href":"https://www.residium.com/de/home-closed/","rel":["nofollow"]},"children":[{"type":"text","value":"discontinued"}]},{"type":"text","value":" by Callom GmbH since September 2021."}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"video","depth":2,"text":"Video"},{"id":"inspiration","depth":2,"text":"Inspiration"}]}},"_type":"markdown","_id":"content:index.md","_source":"content","_file":"index.md","_extension":"md"},{"_path":"/software","_dir":"","_draft":false,"_partial":false,"_locale":"","_empty":false,"title":"Software","description":"","body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"software"},"children":[{"type":"text","value":"Software"}]},{"type":"element","tag":"h2","props":{"id":"the-core"},"children":[{"type":"text","value":"üìü The core"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The core of the project is written in C++ using the Linphone-SDK and the Paho-MQTT library. In order to run the core, checkout the GitHub repository "},{"type":"element","tag":"a","props":{"href":"https://github.com/koifresh/dieklingel-core","rel":["nofollow"]},"children":[{"type":"text","value":"https://github.com/koifresh/dieklingel-core"}]},{"type":"text","value":" for build instructions."}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"the-core","depth":2,"text":"üìü The core"}]}},"_type":"markdown","_id":"content:software.md","_source":"content","_file":"software.md","_extension":"md"}],"navigation":[{"title":"Blog","_path":"/blog","children":[{"title":"doorunit-design-v2","_path":"/blog/doorunit-design-v2"},{"title":"FHEM als T√ºr√∂ffner","_path":"/blog/fhem-als-tueroeffner"}]},{"title":"Contact","_path":"/contact"},{"title":"üïπÔ∏è Hardware","_path":"/hardware"},{"title":"dieKlingel","_path":"/"},{"title":"Software","_path":"/software"}]}